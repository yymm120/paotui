
## chat module

## monitor module

## task module

description: 该模块用于派发任务.


- [ ] [后端] websocket统一使用mpsc消息队列, 需要定义事件枚举, 实现ws_handle逻辑.

- [ ] [前端] 当骑手切换工作状态后, 要连接websocket

- url: `wss://localhost:4000/ws/task`
- protocols: ["task"]

- [ ] [前端&后端] 如果websocket连接成功, 所有交互由websocket提供. 需要重构代码.

- [ ] [前端&后端] 如果websocket连接失败, 如果工作状态仍然working, 立即重连websocket, 每次失败则重连时间延长, 直至2分钟后放弃, 在websocket未连接期间, 前端每隔10s向后端发起请求获取最新数据, 每次下拉刷新时表示该用户活跃中, 需要再次启动重连websocket流程.

- [ ] [前端&后端] 如果用户关闭应用, 则后端应该将工作状态修改为休息中.

- [ ] [前端&后端] 如果用户没有登录, 目前是不允许访问task页面的.

- [ ] [前端] 如果在任务列表处下拉刷新, 根据websocket连接状态, 选择发送事件还是发送请求.


- [ ] [后端] 通过websocket向前端发送task列表.

- [ ] [前端] 封装websocket-hook以及相关工具组件

- [ ] [前端] 接收到task列表后, 重新渲染.

- [ ] [前端] 当切换到已接取任务tab,立即根据连接方式, 向后端检索数据.

- [ ] [前端] 每次接取任务, 只有接取成功后, 才能从带接任务列表中移除任务

- [ ] [前端] 完成任务后, 修改任务状态.

- [ ] [前端&后端] 完成任务后, 通知客户微信

- [ ] [前端] 凡是loading,都要添加loading动效

- [ ] [后端] 如何与微信金融体系接入? (提现和充值功能)
